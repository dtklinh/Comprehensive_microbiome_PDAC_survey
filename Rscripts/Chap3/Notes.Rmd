---
title: "Notes"
author: "Linh Dang"
date: "2025-12-16"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

As a biostatistician dealing with low-biomass samples like PDAC (Pancreatic Ductal Adenocarcinoma), this is a classic "unsupervised" problem. Without a mock community (ground truth), you cannot calculate accuracy, sensitivity, or specificity.

Instead, you must assess the **robustness**, **biological plausibility**, and **signal-to-noise ratio** of your methods.

Here is a statistical framework to compare your decontamination methods (e.g., Decontam, MicroDecon, SCRuB, or manual filtering).

------------------------------------------------------------------------

### 1. Assessment of "Technical Signal" Removal (Batch Effects)

Contaminants often introduce batch effects (e.g., samples extracted on Monday look different from Friday due to kit background). A good decontamination method should reduce technical variation.

-   **Approach:** Perform Ordination (PCoA) and PERMANOVA (adonis2).
-   **Metric:** Check if the variance explained ($R^2$) by "Sequencing Run" or "Extraction Batch" decreases after decontamination.
-   **Logic:** Real tumor microbiomes shouldn't cluster by which kit you used.

### 2. Assessment of "Biological Signal" Enhancement

If you have clinical metadata (e.g., Tumor Stage, Survival, Lymph Node status), the correct decontamination method should theoretically clarify the relationship between the microbiome and the phenotype.

-   **Approach:** Run PERMANOVA using your clinical variables on the raw data vs. the decontaminated datasets.
-   **Metric:** Look for an increase in the $F$-statistic or $R^2$ for biological variables.
-   **R Implementation:** R library(vegan) \# Example: Did decontamination improve the separation between Stage I and Stage II? \# Raw adonis2(dist_raw \~ TumorStage, data = metadata) \# Decontaminated adonis2(dist_decontam \~ TumorStage, data = metadata) *If Method A yields a p-value of 0.04 and Method B yields 0.60, Method A likely preserved the relevant biological signal better.*

### 3. Divergence from Negative Controls (The "Separation" Test)

If you have negative controls (PCR blanks/Extraction blanks), the decontamination method should maximize the dissimilarity between your PDAC samples and those blanks.

-   **Metric:** Calculate the Jensen-Shannon Divergence (or Bray-Curtis) between samples and the pool of negative controls.
-   **Goal:** You want the method that moves the PDAC samples *furthest away* from the composition of the negative controls.

### 4. Consensus Analysis (UpSet Plots)

Since you don't know the truth, trust the **consensus**. If 3 out of 4 methods flag a specific OTU as a contaminant, it is highly likely to be a contaminant.

-   **Visual:** Use an **UpSet Plot** (better than a Venn diagram for \>3 sets) to see the intersection of taxa kept by each method.
-   **Strategy:** Define a "High Confidence Core": Taxa preserved by at least 3 methods.
-   **R Library:** `UpSetR` or `ComplexUpset`.

### 5. Literature-Based Verification (The "Smell Test")

Cross-reference the taxa removed by your methods against known contaminant databases. \* **Known Contaminants:** *Ralstonia*, *Shewanella*, *Bradyrhizobium*, *Cutibacterium acnes*, *Sphingomonas*. (If a method fails to remove these, it is too conservative). \* **Known PDAC Residents:** *Gammaproteobacteria* (specifically *Enterobacteriaceae*), *Fusobacterium nucleatum*. (If a method removes these, it is too aggressive).

### 6. Correlation Topology (Network Analysis)

Contaminants often exhibit "flat" correlations (they appear in every sample at low levels regardless of the host environment) or perfectly correlate with total DNA concentration. \* **Method:** Plot the abundance of top taxa against the **DNA concentration** (Qubit/PicoGreen) of the library input. \* **Logic (Decontam's frequency theory):** If a taxon's relative abundance is inversely proportional to DNA concentration, it is likely a contaminant. If a method fails to remove taxa with this pattern, it is performing poorly.

------------------------------------------------------------------------

### Summary Recommendation for Your Paper/Analysis

Since you lack ground truth, I recommend a **"Sensitivity Analysis"** approach for your manuscript:

1.  **Run 3 methods:** (e.g., Decontam, SCRuB, and a Prevalence Filter).
2.  **Compare the results** using JSD (as you asked in the previous prompt) to see how different the outputs are.
3.  **Select the "Middle Ground" method:**
    -   If Method A removes 2% of reads, Method B removes 90% (too aggressive), and Method C removes 20%, start with C.
4.  **Report the Consensus:** Perform your final statistical analysis (differential abundance, survival analysis) on the dataset generated by your chosen method, but **validate** key findings by checking if they remain significant in at least one other decontamination method.

**Example statement for Methods section:** \> "Due to the lack of a mock community standard, decontamination efficacy was assessed by maximizing the Euclidean distance to negative controls and minimizing batch effects in ordination space. Findings reported herein were robust across two distinct decontamination pipelines (Decontam and MicroDecon)."
